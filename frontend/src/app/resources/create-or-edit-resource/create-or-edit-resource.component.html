<div class="container">
  <div class="row">
    <div class="col">
      <div class="card mt-5">
        <h4 class="card-header">
          <ng-container *ngIf="isNewResource$ | async; let a">
            New post
          </ng-container>
          <ng-container *ngIf="!(isNewResource$ | async)">
            Edit post
          </ng-container>
        </h4>
        <div class="card-body bg-light">
          <div [formGroup]="form">
            <div formGroupName="resource">
              <div formGroupName="info">

                <div class="input-group">

                  <div class="input-group-prepend">
                    <label class="input-group-text" for="call-type" style="width: 8rem">Type</label>
                  </div>
                  <select class="form-select"
                          name="call-type"
                          id="call-type"
                          data-cy="call-type"
                          formControlName="callType">
                    <option [ngValue]="'offer'">Offer</option>
                    <option [ngValue]="'request'">Request</option>
                  </select>
                </div>

                <div class="input-group mt-3">

                  <div class="input-group-prepend">
                    <label class="input-group-text" for="resource-type" style="width: 8rem">Sub Type</label>
                  </div>
                  <select class="form-select"
                          name="resource-type"
                          id="resource-type"
                          data-cy="sub-type"
                          formControlName="resourceType">
                    <option [ngValue]="'service'">Service</option>
                    <option [ngValue]="'object'">Object</option>
                  </select>
                </div>

                <div class="input-group mt-3">
                  <div class="input-group-prepend">
                    <span class="input-group-text" style="width: 8rem">Title</span>
                  </div>
                  <input
                    class="form-control"
                    formControlName="name"
                    type="text"
                    id="commonpool-post-name"
                    name="commonpool-post-name"
                    data-cy="name"
                    autofocus
                    [ngClass]="{ 'is-invalid': submitted && info.controls.name.errors }"
                  >
                  <div *ngIf="submitted && info.controls.name.errors" class="invalid-feedback">
                    <div *ngIf="info.controls.name.errors.required">Title is required</div>
                  </div>
                </div>

                <div class="input-group mt-3">
                  <div class="input-group-prepend">
                    <span class="input-group-text" style="width: 8rem">Description</span>
                  </div>
                  <textarea
                    class="form-control"
                    formControlName="description"
                    id="description"
                    name="description"
                    rows="5"
                    cols="40"
                    data-cy="description"
                    [ngClass]="{ 'is-invalid': submitted && info.controls.description.errors }"
                  ></textarea>
                  <div *ngIf="submitted && info.controls.description.errors" class="invalid-feedback">
                    <div *ngIf="info.controls.description.errors.required">Description is required</div>
                  </div>
                </div>
              </div>
              <div class="mt-4">
                <h5>Values</h5>
                <app-values formControlName="values"></app-values>
              </div>
              <div class="card mt-4 mb-5" formArrayName="sharedWith">
                <div class="card-body">
                  <div *ngIf="memberships$ | async; let memberships">
                    <h5>Share with group(s):</h5>

                    <ng-container *ngIf="memberships.length == 0">
                      You are not a member of any group yet.
                    </ng-container>
                    <ng-container *ngIf="memberships.length > 0">
                      <ul class="list-group mt-3">
                        <li class="list-group-item" *ngFor="let membership of memberships; let i = index">
                          <div class="form-check">

                            <input
                              class="form-check-input"
                              type="checkbox"
                              id="defaultCheck1"

                              [checked]="isToggled(membership.groupId)"
                              (click)="toggleGroup(membership.groupId)"
                            >
                            <label class="form-check-label ml-1" for="defaultCheck1">
                              {{membership.groupName}}
                            </label>
                          </div>
                        </li>
                      </ul>
                    </ng-container>

                  </div>
                </div>
              </div>


              <div class="input-group mt-3">
                <button
                  class="btn btn-primary"
                  type="button"
                  [disabled]="pending"
                  (click)="submit()"
                  data-cy="submit"
                >Submit
                </button>
              </div>
              <div>
                {{ error}}
              </div>


            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<!--  <div class="row mt-3">-->
<!--    <div class="col">-->
<!--      <div class="card">-->
<!--        <div class="card-body">-->
<!--          <pre>{{form.value | json}}</pre>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->

</div>
