<div *ngIf="offerSubject$ | async; let offer">
  <div>
    <span>Status: </span>
    <span class="badge badge-pill badge-primary shadow-sm mr-2" *ngIf="offer.status === 0">Pending</span>
    <span class="badge badge-pill badge-success shadow-sm mr-2" *ngIf="offer.status === 1">Accepted</span>
    <span class="badge badge-pill badge-light shadow-sm mr-2" *ngIf="offer.status === 2">Canceled</span>
    <span class="badge badge-pill badge-danger shadow-sm mr-2" *ngIf="offer.status === 3">Declined</span>
    <span class="badge badge-pill badge-light shadow-sm mr-2" *ngIf="offer.status === 4">Expired</span>
    <span class="badge badge-pill badge-light shadow-sm mr-2" *ngIf="offer.status === 5">Completed</span>
  </div>

  <div class="d-flex">
    <div class="flex-grow-1">
      <div class="mt-3">
        <div *ngFor="let item of offer.items">
          <div class="mt-1">
            <ng-container *ngIf="item.type === 'transfer_credits'">
              Transfer <b>{{item.amount / 3600}}h.</b> worth of credits from <b>
              <app-target [target]="item.from"></app-target>
            </b> to <b>
              <app-target [target]="item.to"></app-target>
            </b>
            </ng-container>
            <ng-container *ngIf="item.type === 'borrow_resource'">
              <b>
                <app-target [target]="item.to"></app-target>
              </b> borrows resource A for <b>{{item.duration / 3600}}h.</b>
            </ng-container>
            <ng-container *ngIf="item.type === 'transfer_resource'">
              <b>
                <app-target [target]="item.to"></app-target>
              </b> takes resource A
            </ng-container>
            <ng-container *ngIf="item.type === 'provide_service'">
              User would get <b>{{item.duration / 3600}}h.</b> worth of Service A
            </ng-container>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="offer.status === 0">
      <ng-container *ngIf="(offerItemsICanApprove$ | async)?.length > 0">
        <button class="btn btn-success btn-sm mr-2" (click)="approve.next()">Accept</button>
        <button class="btn btn-outline-secondary btn-sm" (click)="decline.next()">Decline</button>
      </ng-container>
    </div>
    <div *ngIf="offer.status === 1">
      <div *ngFor="let item of offer.items">
        <ng-container *ngIf="item.type === 'borrow_resource'">
          <div class="d-flex flex-col">
            <button class="btn btn-primary btn-sm" *ngIf="!item.itemGiven || !item.itemTaken"
                    (click)="confirmResourceBorrowed(item.id)">Resource has been
              borrowed
            </button>
            <button class="btn btn-primary btn-sm"
                    *ngIf="(item.itemGiven || item.itemTaken) && (!item.itemReceivedBack && !item.itemReturnedBack)"
                    (click)="confirmResourceBorrowedReturned(item.id)">
              Resource has been returned
            </button>
          </div>
        </ng-container>
        <ng-container *ngIf="item.type === 'transfer_resource'">
          <div>
            <button
              class="btn btn-primary btn-sm"
              *ngIf="!item.itemTaken || !item.itemGiven"
              (click)="confirmResourceTransferred(item.id)">Item was taken
            </button>
          </div>

        </ng-container>
        <ng-container *ngIf="item.type === 'provide_service'">
          <div>
            <button
              class="btn btn-primary btn-sm"
              *ngIf="!item.serviceReceivedConfirmation || !item.serviceGivenConfirmation"
              (click)="confirmServiceProvided(item.id)"
            >Service was provided
            </button>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>

